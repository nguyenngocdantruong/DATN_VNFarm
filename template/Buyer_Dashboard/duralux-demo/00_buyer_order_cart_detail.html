<main class="nxl-container">
    <div class="nxl-content">
        <!-- [ page-header ] start -->
        <div class="page-header">
            <div class="page-header-left d-flex align-items-center">
                <div class="page-header-title">
                    <h5 class="m-b-10">Chi Tiết Giỏ Hàng</h5>
                </div>
                <ul class="breadcrumb">
                    <li class="breadcrumb-item"><a href="index.html">Trang chủ</a></li>
                    <li class="breadcrumb-item"><a href="00_buyer_order_carts.html">Giỏ hàng</a></li>
                    <li class="breadcrumb-item">Chi tiết</li>
                </ul>
            </div>
        </div>
        <!-- [ page-header ] end -->
        <!-- [ Main Content ] start -->
        <div class="main-content">
            <div class="row">
                <div class="col-xxl-9">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="card-title">Giỏ Hàng #GH001</h5>
                        </div>
                        <div class="card-body">
                            <!-- Thông tin giỏ hàng -->
                            <div class="mb-4">
                                <h6 class="mb-3">Thông tin giỏ hàng</h6>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label class="form-label">Mã giỏ hàng</label>
                                            <input type="text" class="form-control" value="#GH001" readonly>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label class="form-label">Ngày tạo</label>
                                            <input type="text" class="form-control" value="20/03/2024" readonly>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label class="form-label">Tên cửa hàng</label>
                                            <input type="text" class="form-control" value="Shop ABC" readonly>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label class="form-label">Trạng thái</label>
                                            <input type="text" class="form-control" value="Đang hoạt động" readonly>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Danh sách sản phẩm -->
                            <div class="mb-4">
                                <div class="d-flex justify-content-between align-items-center mb-3">
                                    <h6 class="mb-0">Danh sách sản phẩm</h6>
                                    <div class="dropdown">
                                        <button class="btn btn-primary btn-sm dropdown-toggle" type="button" data-bs-toggle="dropdown">
                                            <i class="feather-plus me-2"></i>
                                            Thêm sản phẩm
                                        </button>
                                        <div class="dropdown-menu dropdown-menu-end p-3" style="width: 75vw;">
                                            <div class="mb-3">
                                                <label class="form-label">Tìm kiếm sản phẩm</label>
                                                <div class="input-group">
                                                    <span class="input-group-text"><i class="feather-search"></i></span>
                                                    <input type="text" class="form-control" placeholder="Nhập tên sản phẩm...">
                                                </div>
                                            </div>
                                            <div class="table-responsive" style="max-height: 300px;">
                                                <table class="table table-sm">
                                                    <thead>
                                                        <tr>
                                                            <th>Sản phẩm</th>
                                                            <th>Đơn giá</th>
                                                            <th>Số lượng</th>
                                                            <th>Thao tác</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr>
                                                            <td>
                                                                <div class="d-flex align-items-center">
                                                                    <img src="assets/images/product/3.jpg" alt="Product" class="img-thumbnail me-2" style="width: 40px;">
                                                                    <div>
                                                                        <h6 class="mb-0">Sản phẩm C</h6>
                                                                        <small class="text-muted">Màu: Xanh</small>
                                                                    </div>
                                                                </div>
                                                            </td>
                                                            <td>300.000đ</td>
                                                            <td>
                                                                <div class="input-group input-group-sm" style="width: 100px;">
                                                                    <button class="btn btn-outline-secondary" type="button">-</button>
                                                                    <input type="number" class="form-control text-center" value="1">
                                                                    <button class="btn btn-outline-secondary" type="button">+</button>
                                                                </div>
                                                            </td>
                                                            <td>
                                                                <button class="btn btn-sm btn-primary">
                                                                    <i class="feather-plus"></i>
                                                                </button>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td>
                                                                <div class="d-flex align-items-center">
                                                                    <img src="assets/images/product/4.jpg" alt="Product" class="img-thumbnail me-2" style="width: 40px;">
                                                                    <div>
                                                                        <h6 class="mb-0">Sản phẩm D</h6>
                                                                        <small class="text-muted">Màu: Đỏ</small>
                                                                    </div>
                                                                </div>
                                                            </td>
                                                            <td>250.000đ</td>
                                                            <td>
                                                                <div class="input-group input-group-sm" style="width: 100px;">
                                                                    <button class="btn btn-outline-secondary" type="button">-</button>
                                                                    <input type="number" class="form-control text-center" value="1">
                                                                    <button class="btn btn-outline-secondary" type="button">+</button>
                                                                </div>
                                                            </td>
                                                            <td>
                                                                <button class="btn btn-sm btn-primary">
                                                                    <i class="feather-plus"></i>
                                                                </button>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="table-responsive">
                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th>Sản phẩm</th>
                                                <th>Đơn giá</th>
                                                <th>Số lượng</th>
                                                <th>Thành tiền</th>
                                                <th>Báo giá từ người bán</th>
                                                <th>Thao tác</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>
                                                    <div class="d-flex align-items-center">
                                                        <img src="assets/images/product/1.jpg" alt="Product" class="img-thumbnail me-3" style="width: 50px;">
                                                        <div>
                                                            <h6 class="mb-1">Sản phẩm A</h6>
                                                            <p class="text-muted mb-0">Màu: Đen</p>
                                                        </div>
                                                    </div>
                                                </td>
                                                <td>400.000đ</td>
                                                <td>
                                                    <div class="input-group input-group-sm" style="width: 120px;">
                                                        <button class="btn btn-outline-secondary" type="button">-</button>
                                                        <input type="number" class="form-control text-center" value="2">
                                                        <button class="btn btn-outline-secondary" type="button">+</button>
                                                    </div>
                                                </td>
                                                <td>800.000đ</td>
                                                <td>
                                                    <div class="d-flex align-items-center">
                                                        <span class="text-success me-2">380.000đ</span>
                                                        <button class="btn btn-sm btn-outline-success" data-bs-toggle="tooltip" title="Đã được báo giá">
                                                            <i class="feather-check-circle"></i>
                                                        </button>
                                                    </div>
                                                </td>
                                                <td>
                                                    <button class="btn btn-sm btn-danger">
                                                        <i class="feather-trash-2"></i>
                                                    </button>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <div class="d-flex align-items-center">
                                                        <img src="assets/images/product/2.jpg" alt="Product" class="img-thumbnail me-3" style="width: 50px;">
                                                        <div>
                                                            <h6 class="mb-1">Sản phẩm B</h6>
                                                            <p class="text-muted mb-0">Màu: Trắng</p>
                                                        </div>
                                                    </div>
                                                </td>
                                                <td>200.000đ</td>
                                                <td>
                                                    <div class="input-group input-group-sm" style="width: 120px;">
                                                        <button class="btn btn-outline-secondary" type="button">-</button>
                                                        <input type="number" class="form-control text-center" value="1">
                                                        <button class="btn btn-outline-secondary" type="button">+</button>
                                                    </div>
                                                </td>
                                                <td>200.000đ</td>
                                                <td>
                                                    <div class="d-flex align-items-center">
                                                        <span class="text-warning me-2">Chờ báo giá</span>
                                                        <button class="btn btn-sm btn-outline-warning" data-bs-toggle="tooltip" title="Đang chờ báo giá">
                                                            <i class="feather-clock"></i>
                                                        </button>
                                                    </div>
                                                </td>
                                                <td>
                                                    <button class="btn btn-sm btn-danger">
                                                        <i class="feather-trash-2"></i>
                                                    </button>
                                                </td>
                                            </tr>
                                        </tbody>
                                        <tfoot>
                                            <tr>
                                                <td colspan="3" class="text-end"><strong>Tổng tiền:</strong></td>
                                                <td><strong>1.000.000đ</strong></td>
                                                <td colspan="2"></td>
                                            </tr>
                                        </tfoot>
                                    </table>
                                </div>
                            </div>

                            <!-- Nút thao tác -->
                            <div class="d-flex justify-content-between">
                                <div class="d-flex justify-content-start">
                                    <button type="button" class="btn btn-light me-2" onclick="history.back()">
                                        <i class="feather-arrow-left me-2"></i>
                                        Quay lại
                                    </button>
                                    <button type="button" class="btn btn-info me-2" data-bs-toggle="modal" data-bs-target="#chatModal">
                                        <i class="feather-message-circle me-2"></i>
                                        Chat với người bán
                                    </button>
                                    <button type="button" class="btn btn-warning me-2" data-bs-toggle="modal" data-bs-target="#requestQuoteModal">
                                        <i class="feather-file-text me-2"></i>
                                        Yêu cầu báo giá
                                    </button>
                                    <button type="button" class="btn btn-primary">
                                        <i class="feather-shopping-cart me-2"></i>
                                        Tiến hành đặt hàng
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-xxl-3">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="card-title">Thông tin bổ sung</h5>
                        </div>
                        <div class="card-body">
                            <div class="alert alert-info">
                                <h6 class="alert-heading">Lưu ý:</h6>
                                <ul class="mb-0 ps-3">
                                    <li>Giỏ hàng sẽ tự động hết hạn sau 24h</li>
                                    <li>Có thể yêu cầu báo giá cho toàn bộ đơn hàng</li>
                                    <li>Chat trực tiếp với người bán để được tư vấn</li>
                                    <li>Kiểm tra kỹ thông tin trước khi đặt hàng</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- [ Main Content ] end -->
    </div>

    <!-- Modal Chat -->
    <div class="modal fade" id="chatModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Chat với Shop ABC</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="chat-messages" style="height: 300px; overflow-y: auto;">
                        <div class="message message-received mb-3">
                            <div class="message-content">
                                Xin chào! Tôi có thể giúp gì cho bạn?
                            </div>
                        </div>
                        <div class="message message-sent mb-3">
                            <div class="message-content">
                                Tôi muốn hỏi về sản phẩm trong giỏ hàng
                            </div>
                        </div>
                    </div>
                    <div class="chat-input mt-3">
                        <div class="input-group">
                            <input type="text" class="form-control" placeholder="Nhập tin nhắn...">
                            <button class="btn btn-primary">
                                <i class="feather-send"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Yêu cầu báo giá -->
    <div class="modal fade" id="requestQuoteModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Yêu cầu báo giá</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label class="form-label">Ghi chú</label>
                        <textarea class="form-control" rows="3" placeholder="Nhập ghi chú cho người bán..."></textarea>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Yêu cầu đặc biệt</label>
                        <textarea class="form-control" rows="3" placeholder="Nhập yêu cầu đặc biệt (nếu có)..."></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">Hủy</button>
                    <button type="button" class="btn btn-primary">Gửi yêu cầu</button>
                </div>
            </div>
        </div>
    </div>

    <!-- [ Footer ] start -->
    <footer class="footer">
        <p class="fs-11 text-muted fw-medium text-uppercase mb-0 copyright">
            <span>Copyright ©</span>
            <script data-cfasync="false" src="../../../cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>
                document.write(new Date().getFullYear());
            </script>
        </p>
        <div class="d-flex align-items-center gap-4">
            <a href="javascript:void(0);" class="fs-11 fw-semibold text-uppercase">Help</a>
            <a href="javascript:void(0);" class="fs-11 fw-semibold text-uppercase">Terms</a>
            <a href="javascript:void(0);" class="fs-11 fw-semibold text-uppercase">Privacy</a>
        </div>
    </footer>
    <!-- [ Footer ] end -->
</main>

<style>
    .message {
        max-width: 80%;
    }
    .message-received {
        margin-right: auto;
    }
    .message-sent {
        margin-left: auto;
    }
    .message-content {
        padding: 10px 15px;
        border-radius: 15px;
        background-color: #f8f9fa;
    }
    .message-sent .message-content {
        background-color: #0d6efd;
        color: white;
    }
</style>

<script>
    // Xử lý tăng/giảm số lượng
    document.querySelectorAll('.input-group-sm input[type="number"]').forEach(input => {
        const minusBtn = input.previousElementSibling;
        const plusBtn = input.nextElementSibling;
        
        minusBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            if (input.value > 1) {
                input.value = parseInt(input.value) - 1;
                updateTotal();
            }
        });
        
        plusBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            input.value = parseInt(input.value) + 1;
            updateTotal();
        });
        
        input.addEventListener('change', (e) => {
            e.stopPropagation();
            updateTotal();
        });
    });

    // Ngăn chặn sự kiện click trong dropdown
    document.querySelector('.dropdown-menu').addEventListener('click', (e) => {
        e.stopPropagation();
    });

    // Ngăn chặn sự kiện click cho nút thêm sản phẩm
    document.querySelectorAll('.dropdown-menu .btn-primary').forEach(btn => {
        btn.addEventListener('click', (e) => {
            e.stopPropagation();
            // Thêm xử lý thêm sản phẩm ở đây
            alert('Đã thêm sản phẩm vào giỏ hàng!');
        });
    });
    
    function updateTotal() {
        // Tính toán lại tổng tiền
        let total = 0;
        document.querySelectorAll('tbody tr').forEach(row => {
            const price = parseInt(row.querySelector('td:nth-child(2)').textContent.replace(/[^0-9]/g, ''));
            const quantity = parseInt(row.querySelector('input[type="number"]').value);
            total += price * quantity;
        });
        document.querySelector('tfoot strong:last-child').textContent = total.toLocaleString('vi-VN') + 'đ';
    }
</script> 